@model TPIntegrador_PWeb3.DAL.Usuarios
@{
    ViewBag.Title = "HomeUsuario";
}

<a href="../../Home/Index">MENU</a><br />
@if (TPIntegrador_PWeb3.Helper.SessionHelper.Nombre != null)
{
    if (Model.Nombre != null)
    {
        <h2>
            Bienvenido   @Model.Nombre !!!
        </h2>
        <br />

        <img height="100" width="100" src="../img/@Model.Foto" />

    }

    <h4> Usuario  @Model.Email </h4>
    <h4> <a href="historial/@Model.IdUsuario">Historial donaciones</a></h4>
    <br />
    <form action="necesidadesActivas" method="get">

        <button type="submit" class="btn-lg">

            VER SOLO MIS NECESIDADES ACTIVAS

        </button>
    </form>
    if (@ViewBag.necesidadesActivas != null)
    {
        <h1> "Mis Necesidades Activas"</h1>
        foreach (var item in @ViewBag.necesidadesActivas)
        {

            <h4>@item.Nombre</h4>

            <h4>Fecha de cierre:</h4>
            <h4>@item.FechaFin</h4>


            <a href="../Necesidades/detallesNecesidad/@item.IdNecesidad">Ver detalles </a>


        }
    }

    else if (@Model.Necesidades.Count != 0)
    {
        <h1> "Mis Necesidades"</h1>
        <div class="row">
            @foreach (var item in @Model.Necesidades)
            {
                if (item.Estado != 0)
                {
                    <div class="col-md-6">
                        <h4>@item.Nombre</h4>

                        @if (@item.NecesidadesValoraciones.Count != 0)
                        {
                            <h4>Valoracion actual:</h4>
                            <h4> @item.NecesidadesValoraciones.Last().Valoracion</h4>
                        }
                        <h4>Fecha de cierre:</h4>
                        <h4>@item.FechaFin</h4>

                        <a href="../Necesidades/detallesNecesidad/@item.IdNecesidad">Ver detalles </a>
                        @if (@item.FechaFin != null && @item.FechaFin.CompareTo(DateTime.Now) == 1)
                        {


                            <a href="../Necesidades/modificarNecesidad/@item.IdNecesidad">Modificar</a>


                        }<br />

                    </div>



                }

            }
        </div>
    }
    if (@ViewBag.usuarios != null)
    {

        <h1> "Necesidades de otros usuarios"</h1>

        foreach (var usuario in @ViewBag.usuarios)
        {
            <h4>Usuario: @usuario.Email</h4>
            if (@usuario.Necesidades != null)
            {

                foreach (var item in @usuario.Necesidades)
                {
                    if (@item.Estado != 0)
                    {
                        <h4>@item.Nombre</h4>

                        <h4>Fecha de cierre:</h4>
                        <h4>@item.FechaFin</h4>

                        <a href="../Necesidades/detallesNecesidad/@item.IdNecesidad">Ver detalles </a>

                    }
                }
            }
        }
    }


    <br>
    <br />
    <a href="../Necesidades/crear"><h3 class="text-SUCCESS">CREAR NECESIDAD</h3></a>
    <br />

    if (Model.TipoUsuario == 1)
    {
        <a href="gestionarDenuncias"><h3 class="text-danger">GESTIONAR DENUNCIAS</h3></a>}

    <br>
    <br />




}





























